lines(gtemp$Year, m1.preds$fit, lwd=2, col="red")
lines(gtemp$Year, m1.preds$fit-m1.preds$se.fit, col="red", lty=2)
lines(gtemp$Year, m1.preds$fit+m1.preds$se.fit, col="red", lty=2)
plot.gam(m1, shade=TRUE, residuals=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, lwd=2, col="red")
lines(gtemp$Year, m1.preds$fit-m1.preds$se.fit, col="red", lty=2)
lines(gtemp$Year, m1.preds$fit+m1.preds$se.fit, col="red", lty=2)
forjags <- list(Year=gtemp$Year,
Annua=gtemp$Annual,
N.obs=nrow(gtemp))
forjags
jags.ready <- jagam(Annual ~ s(Year),
data=gtemp,
family="poisson",
file="jagam.txt")
jags.ready <- jagam(Annual ~ s(Year),
data=gtemp,
file="jagam.txt")
readLines("jagam.txt")
library(R2jags)
model.fit <- jags(data=jags.ready,
model.file="jagam.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=1000,
n.burnin=500)
jagam.model <- jagam(Annual ~ s(Year),
data=gtemp,
file="jagam_model.txt")
readLines("jagam_model.txt")
jagam.model$jags.data
library(R2jags)
model.fit <- jags(data=jags.ready,
model.file="jagam.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=1000,
n.burnin=500)
library(R2jags)
model.fit <- jags(data=jagam.model$jags.data,
model.file="jagam_model.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=1000,
n.burnin=500)
mode.fit$BUGSoutput
model.fit
model.fit$BUTSoutput
model.fit$BUGSoutput
model.fit$BUGSoutput$50%
data.frame(model.fit$BUGSoutput)
data.frame(model.fit$BUGSoutput)
data.frame(model.fit$BUGSoutput$summary)
preds <- data.frame(model.fit$BUGSoutput$summary)
head(preds)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, preds$X50.)
preds <- data.frame(model.fit$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, preds$X50.)
nrow(preds)
nrow(gtemp)
?jags
library(R2jags)
model.fit <- jags(data=jagam.model$jags.data,
model.file="jagam_model.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=1000,
n.burnin=500,
deviance=FALSE)
library(R2jags)
model.fit <- jags(data=jagam.model$jags.data,
model.file="jagam_model.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=1000,
n.burnin=500,
DIC=FALSE)
preds <- data.frame(model.fit$BUGSoutput$summary)
head(preds)
preds <- data.frame(model.fit$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, preds$X50.)
lines(gtemp$Year, preds$X2.5., lty=2)
lines(gtemp$Year, preds$X97.5., lty=2)
lines(gtemp$Year, preds$X50., col="red", lwd=2)
preds <- data.frame(model.fit$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
preds <- data.frame(model.fit$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", Bayesian prediction)
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
preds <- data.frame(model.fit$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", main="Bayesian prediction")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
cat("
model {
mu <- X %*% b ## expected response
for (i in 1:n) { y[i] ~ dnorm(mu[i],tau) } ## response
scale <- 1/tau ## convert tau to standard GLM scale
tau ~ dgamma(.05,.005) ## precision parameter prior
## Parametric effect priors CHECK tau=1/1.7^2 is appropriate!
for (i in 1:1) { b[i] ~ dnorm(0,0.36) }
## prior for s(Year)...
K1 <- S1[1:9,1:9] * lambda[1]  + S1[1:9,10:18] * lambda[2]
b[2:10] ~ dmnorm(zero[2:10],K1)
## smoothing parameter priors CHECK...
for (i in 1:2) {
lambda[i] ~ dgamma(.05,.005)
rho[i] <- log(lambda[i])
}
# PREDICTIONS
for (i in 1:n)
{
pred[i] ~ dnorm(mu[i],tau)
}
}
", file="jagam_model_with_preds.txt")
library(R2jags)
model.fit <- jags(data=jagam.model$jags.data,
model.file="jagam_model_with_preds.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=1000,
n.burnin=500,
DIC=FALSE)
preds <- data.frame(model.fit$BUGSoutput$summary)
preds
library(R2jags)
model.fit <- jags(data=jagam.model$jags.data,
model.file="jagam_model_with_preds.txt",
parameters.to.save=c("pred"),
n.chains=3,
n.iter=1000,
n.burnin=500,
DIC=FALSE)
preds <- data.frame(model.fit$BUGSoutput$summary)
preds <- data.frame(model.fit$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", main="Full Bayesian prediction interval")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
library(R2jags)
model.fit <- jags(data=jagam.model$jags.data,
model.file="jagam_model_with_preds.txt",
parameters.to.save=c("pred"),
n.chains=3,
n.iter=10000,
n.burnin=5000,
DIC=FALSE)
preds <- data.frame(model.fit$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", main="Full Bayesian prediction interval")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
?gam
head(gtemp)
jagam.model <- jagam(Annual ~ s(Year) + Jan,
data=gtemp,
file="jagam_model.txt")
readLines("jagam_model.txt")
jagam.model <- jagam(Annual ~ s(Year) + Jan + Sep,
jagam.model <- jagam(Annual ~ s(Year) + Jan + Sep,
data=gtemp,
file="jagam_model.txt")
readLines("jagam_model.txt")
jagam.model <- jagam(Annual ~ s(Year) + Jan,
data=gtemp,
file="jagam_model.txt")
readLines("jagam_model.txt")
?ar
ts(data.frame(Year=gtemp$Year, Annual=gtemp$Annual))
a <- ts(data.frame(Year=gtemp$Year, Annual=gtemp$Annual))
plot(a)
a <- ts(data=gtemp$Year)
plot(a)
a <- ts(data=gtemp$Annual)
a
plot(a)
ar(a)
aa <- ar(a)
aa
plot(a)
plot(aa)
summary(aa)
plot(aa)
ann <- ts(data=gtemp$Annual)
ann <- gtemp$Annual
ann.minus1 <- c(0, ann[-length(ann)])
plot(ann, ann.minus1)
Ann.tminus1 <- c(0, gtemp$Annual[-length(gtemp$Annual)])
gtemp <- data.frame(Annual, Annual.tminus1)
Annual.tminus1 <- c(0, gtemp$Annual[-length(gtemp$Annual)])
gtemp <- data.frame(Annual, Annual.tminus1)
gtemp <- data.frame(gtemp, Annual.tminus1)
head(gtemp)
jagam.model.ar <- jagam(Annual ~ s(Year) + Annual.tminus1,
data=gtemp,
file="jagam_model_ar.txt")
library(R2jags)
model.fit <- jags(data=jagam.model$jags.data,
model.file="jagam_model_ar.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=1000,
n.burnin=500,
DIC=FALSE)
library(R2jags)
model.fit.ar <- jags(data=jagam.model$jags.data,
model.file="jagam_model_ar.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=1000,
n.burnin=500,
DIC=FALSE)
preds <- data.frame(model.fit$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", main="Full Bayesian prediction interval")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
lm(Annual ~ Annual.minus.1, data=gtemp)
lm(Annual ~ Annual.tminus.1, data=gtemp)
head(gtemp)
lm(Annual ~ Annual.tminus.1, data=gtemp)
lm(Annual ~ Annual.tminus1, data=gtemp)
ar(a)
?ar
ar(a, order.max=1)
lm(Annual ~ Annual.tminus1, data=gtemp)
?lm
lm(Annual ~ 0 + Annual.tminus1, data=gtemp)
ar(a, order.max=1)
library(R2jags)
model.fit.ar <- jags(data=jagam.model.ar$jags.data,
model.file="jagam_model_ar.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=1000,
n.burnin=500,
DIC=FALSE)
preds <- data.frame(model.fit$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", main="Full Bayesian prediction interval")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
preds <- data.frame(model.fit.ar$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", main="Full Bayesian prediction interval")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
?gamm
?jagam
m1 <- gam(Annual ~ s(Year),
data=gtemp,
correlation=coAR1(form= ~ Year, p=1))
m1.preds <- predict(m1, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, lwd=2, col="red")
lines(gtemp$Year, m1.preds$fit-m1.preds$se.fit, col="red", lty=2)
lines(gtemp$Year, m1.preds$fit+m1.preds$se.fit, col="red", lty=2)
m1 <- gam(Annual ~ s(Year), data=gtemp)
m1.preds <- predict(m1, type="response", se.fit=TRUE)
lines(gtemp$Year, m1.preds$fit, lwd=2, col="blue")
m1 <- gam(Annual ~ s(Year),
data=gtemp,
correlation=coAR1(form= ~ Year, p=1))
m1.preds <- predict(m1, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, lwd=2, col="red")
lines(gtemp$Year, m1.preds$fit-m1.preds$se.fit, col="red", lty=2)
lines(gtemp$Year, m1.preds$fit+m1.preds$se.fit, col="red", lty=2)
m1 <- gam(Annual ~ s(Year),
data=gtemp,
correlation=corAR1(form= ~ Year, p=1))
m1.preds <- predict(m1, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, lwd=2, col="red")
lines(gtemp$Year, m1.preds$fit-m1.preds$se.fit, col="red", lty=2)
lines(gtemp$Year, m1.preds$fit+m1.preds$se.fit, col="red", lty=2)
m1 <- gam(Annual ~ s(Year), data=gtemp)
m1.preds <- predict(m1, type="response", se.fit=TRUE)
lines(gtemp$Year, m1.preds$fit-m1.preds$se.fit, col="blue", lty=2)
m1 <- gam(Annual ~ s(Year),
data=gtemp,
correlation=corARMA(form= ~ Year, p=1))
m2 <- gam(Annual ~ s(Year),
data=gtemp)
m1.preds <- predict(m1, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit-m1.preds$se.fit, col="red", lty=2)
lines(gtemp$Year, m2.preds$fit-m2.preds$se.fit, col="red", lty=2)
m1.preds <- predict(m1, type="response", se.fit=TRUE)
m2.preds <- predict(m2, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, col="red", lty=2)
lines(gtemp$Year, m2.preds$fit, col="red", lty=2)
m1 <- gamm(Annual ~ s(Year),
data=gtemp,
correlation=corARMA(form= ~ Year, p=1))
m2 <- gamm(Annual ~ s(Year),
data=gtemp)
m1.preds <- predict(m1, type="response", se.fit=TRUE)
m2.preds <- predict(m2, type="response", se.fit=TRUE)
m1.preds <- predict(m1$gam, type="response", se.fit=TRUE)
m2.preds <- predict(m2$gam, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, col="red", lty=2)
lines(gtemp$Year, m2.preds$fit, col="red", lty=2)
library(mgcv)
m1 <- gamm(Annual ~ s(Year),
data=gtemp,
correlation=corARMA(form= ~ Year, p=1))
m2 <- gamm(Annual ~ s(Year),
data=gtemp)
m1.preds <- predict(m1$gam, type="response", se.fit=TRUE)
m2.preds <- predict(m2$gam, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, col="red")
lines(gtemp$Year, m2.preds$fit, col="blue")
library(mgcv)
m1 <- gamm(Annual ~ s(Year),
data=gtemp,
correlation=corAR1(form= ~ Year, p=1))
m2 <- gamm(Annual ~ s(Year),
data=gtemp)
m1.preds <- predict(m1$gam, type="response", se.fit=TRUE)
m2.preds <- predict(m2$gam, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, col="red")
lines(gtemp$Year, m2.preds$fit, col="blue")
library(mgcv)
m1 <- gamm(Annual ~ s(Year),
data=gtemp,
correlation=corAR1(form= ~ Year))
m2 <- gamm(Annual ~ s(Year),
data=gtemp)
m1.preds <- predict(m1$gam, type="response", se.fit=TRUE)
m2.preds <- predict(m2$gam, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, col="red")
lines(gtemp$Year, m2.preds$fit, col="blue")
library(mgcv)
m1 <- gamm(Annual ~ s(Year),
data=gtemp,
correlation=corAR1(form= ~ Year))
m2 <- gamm(Annual ~ s(Year),
data=gtemp,
correlation=corARMA(form= ~ Year))
m2 <- gamm(Annual ~ s(Year),
data=gtemp)
m1.preds <- predict(m1$gam, type="response", se.fit=TRUE)
m2.preds <- predict(m2$gam, type="response", se.fit=TRUE)
m3.preds <- predict(m3$gam, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, col="red")
lines(gtemp$Year, m2.preds$fit, col="blue")
lines(gtemp$Year, m3.preds$fit, col="green")
library(mgcv)
m1 <- gamm(Annual ~ s(Year),
data=gtemp,
correlation=corAR1(form= ~ Year))
m2 <- gamm(Annual ~ s(Year),
data=gtemp,
correlation=corARMA(form= ~ Year, p=1))
m2 <- gamm(Annual ~ s(Year),
data=gtemp)
m1.preds <- predict(m1$gam, type="response", se.fit=TRUE)
m2.preds <- predict(m2$gam, type="response", se.fit=TRUE)
m3.preds <- predict(m3$gam, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, col="red")
lines(gtemp$Year, m2.preds$fit, col="blue")
lines(gtemp$Year, m3.preds$fit, col="green")
library(mgcv)
m1 <- gamm(Annual ~ s(Year),
data=gtemp,
correlation=corAR1(form= ~ Year))
m2 <- gamm(Annual ~ s(Year),
data=gtemp,
correlation=corARMA(form= ~ Year, p=1))
m3 <- gamm(Annual ~ s(Year),
data=gtemp)
m1.preds <- predict(m1$gam, type="response", se.fit=TRUE)
m2.preds <- predict(m2$gam, type="response", se.fit=TRUE)
m3.preds <- predict(m3$gam, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, col="red")
lines(gtemp$Year, m2.preds$fit, col="blue")
lines(gtemp$Year, m3.preds$fit, col="green")
?predict.gam
library(mgcv)
m1 <- gamm(Annual ~ s(Year),
data=gtemp,
correlation=corAR1(form= ~ Year))
m2 <- gamm(Annual ~ s(Year),
data=gtemp,
correlation=corARMA(form= ~ Year, p=1))
m3 <- gamm(Annual ~ s(Year),
data=gtemp)
m1.preds <- predict(m1$gam, type="iterms", se.fit=TRUE)
m2.preds <- predict(m2$gam, type="response", se.fit=TRUE)
m3.preds <- predict(m3$gam, type="response", se.fit=TRUE)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, m1.preds$fit, col="red")
lines(gtemp$Year, m2.preds$fit, col="blue")
lines(gtemp$Year, m3.preds$fit, col="green")
?gam
library(R2jags)
model.fit.ar <- jags(data=jagam.model.ar$jags.data,
model.file="jagam_model_ar.txt",
parameters.to.save=c("mu", "b"),
n.chains=3,
n.iter=1000,
n.burnin=500,
DIC=FALSE)
model.fit.ar$BUGSoutput$summary
preds.mu <- preds[12:nrow(preds),]
preds.b <- preds[1:11,]
preds.b
preds <- data.frame(model.fit.ar$BUGSoutput$summary)
preds
preds.b <- preds[1:11,]
preds.b
preds <- data.frame(model.fit.ar$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", main="Full Bayesian prediction interval")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
library(R2jags)
model.fit.ar <- jags(data=jagam.model.ar$jags.data,
model.file="jagam_model_ar.txt",
parameters.to.save=c("mu", "b"),
n.chains=3,
n.iter=1000,
n.burnin=500,
DIC=FALSE)
preds <- data.frame(model.fit.ar$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", main="Full Bayesian prediction interval")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
library(R2jags)
model.fit.ar <- jags(data=jagam.model.ar$jags.data,
model.file="jagam_model_ar.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=1000,
n.burnin=500,
DIC=FALSE)
preds <- data.frame(model.fit.ar$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", main="Full Bayesian prediction interval")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
library(R2jags)
model.fit.ar <- jags(data=jagam.model.ar$jags.data,
model.file="jagam_model_ar.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=10000,
n.burnin=5000,
DIC=FALSE)
preds <- data.frame(model.fit.ar$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", main="Full Bayesian prediction interval")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
acf(preds$X50.)
preds <- data.frame(model.fit.ar$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", main="Full Bayesian prediction interval")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
acf(gtemp$Annual-preds$X50.)
ma3
acf(preds$X50.)
acf(gtemp$Annual, preds$X50.)
acf(gtemp$Annual-preds$X50.)
library(R2jags)
model.fit <- jags(data=jagam.model$jags.data,
model.file="jagam_model.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=1000,
n.burnin=500,
DIC=FALSE)
jagam.model <- jagam(Annual ~ s(Year),
data=gtemp,
file="jagam_model.txt")
readLines("jagam_model.txt")
library(R2jags)
model.fit <- jags(data=jagam.model$jags.data,
model.file="jagam_model.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=1000,
n.burnin=500,
DIC=FALSE)
preds <- data.frame(model.fit$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b", main="Bayesian estimate of the mean")
lines(gtemp$Year, preds$X50., col="red", lwd=2)
lines(gtemp$Year, preds$X2.5., lty=2, col="red")
lines(gtemp$Year, preds$X97.5., lty=2, col="red")
acf(gtemp$Annual-preds$X50.)
