model.file="ar.txt",
parameters.to.save=c("beta0", "beta1"),
n.chains=3,
n.iter=2000,
n.burnin=1000)
model.fit
gtemp <- read.csv("http://www.petrkeil.com/wp-content/uploads/2016/01/gtemp.csv")
plot(Annual~Year, data=gtemp, type="b")
par(mfrow=c(1,2))
plot(gtemp$Annual[-164], gtemp$Annual[-1],
xlab="T in Year", ylab="T in Year-1")
acf(gtemp$Annual, main="")
ar.data <- list(Annual = gtemp$Annual,
N = nrow(gtemp))
library(R2jags)
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
# likelihood
mu[1] ~ dnorm(0, 0.001)
for(t in 2:N)
{
Annual[t] ~ dnorm(mu[t], tau)
mu[t] <- beta0 + beta1*Annual[t-1]
}
}
", file="ar.txt")
model.fit <- jags(data=ar.data,
model.file="ar.txt",
parameters.to.save=c("beta0", "beta1"),
n.chains=3,
n.iter=2000,
n.burnin=1000)
model.fit
mus <- jags(data=ar.data,
model.file="ar.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=2000,
n.burnin=1000,
DIC=FALSE)
mus <- data.frame(mus$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year[-1], mus$X50., col="red", lwd=2)
lines(gtemp$Year, mus$X50., col="red", lwd=2)
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
# likelihood
mu[1] ~ dnorm(0, 0.001)
for(t in 2:N)
{
mu[t] <- beta0 + beta1*Annual[t-1]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="ar.txt")
model.fit <- jags(data=ar.data,
model.file="ar.txt",
parameters.to.save=c("beta0", "beta1"),
n.chains=3,
n.iter=2000,
n.burnin=1000)
model.fit
mus <- jags(data=ar.data,
model.file="ar.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=2000,
n.burnin=1000,
DIC=FALSE)
mus <- data.frame(mus$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, mus$X50., col="red", lwd=2)
model.fit <- jags(data=ar.data,
model.file="ar.txt",
parameters.to.save=c("beta0", "beta1"),
n.chains=3,
n.iter=2000,
n.burnin=1000)
model.fit
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
# likelihood
mu[1] ~ Annual[1] - eps[1]
eps[1] ~ dnorm(0, 0.001)
for(t in 2:N)
{
mu[t] <- beta0 + beta1*Annual[t-1]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="ar1.txt")
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
# likelihood
mu[1] ~ Annual[1] - eps[1]
eps[1] ~ dnorm(0, 0.001)
for(t in 2:N)
{
mu[t] <- beta0 + beta1*eps[t-1]
eps[t] <- Annual[t] - mu[t]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="ar2.txt")
mus <- jags(data=ar.data,
model.file="ar2.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=2000,
n.burnin=1000,
DIC=FALSE)
mus <- data.frame(mus$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, mus$X50., col="red", lwd=2)
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
# likelihood
mu[1] <- Annual[1] - eps[1]
eps[1] ~ dnorm(0, 0.001)
for(t in 2:N)
{
mu[t] <- beta0 + beta1*eps[t-1]
eps[t] <- Annual[t] - mu[t]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="ar2.txt")
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
# likelihood
mu[1] <- Annual[1] - eps[1]
eps[1] ~ dnorm(0, 0.001)
for(t in 2:N)
{
mu[t] <- beta0 + beta1*Annual[t-1]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="ar1.txt")
model.fit <- jags(data=ar.data,
model.file="ar1.txt",
parameters.to.save=c("beta0", "beta1"),
n.chains=3,
n.iter=2000,
n.burnin=1000)
model.fit
mus <- jags(data=ar.data,
model.file="ar1.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=2000,
n.burnin=1000,
DIC=FALSE)
mus <- data.frame(mus$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, mus$X50., col="red", lwd=2)
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
# likelihood
mu[1] <- Annual[1] - eps[1]
eps[1] ~ dnorm(0, 0.001)
for(t in 2:N)
{
mu[t] <- beta0 + beta1*Annual[t-1]
eps[t] <- Annual[t] - mu[t]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="ar1.txt")
model.fit <- jags(data=ar.data,
model.file="ar1.txt",
parameters.to.save=c("beta0", "beta1"),
n.chains=3,
n.iter=2000,
n.burnin=1000)
model.fit
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
# likelihood
mu[1] <- Annual[1] - eps[1]
eps[1] ~ dnorm(0, 0.001)
for(t in 2:N)
{
mu[t] <- beta0 + beta1*Annual[t-1]
eps[t] <- Annual[t] - mu[t]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="ar1.txt")
model.fit <- jags(data=ar.data,
model.file="ar1.txt",
parameters.to.save=c("beta0", "beta1"),
n.chains=3,
n.iter=2000,
n.burnin=1000)
model.fit
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
mu[1] ~ dnorm(0, 0.001)
# likelihood
eps[1] <- Annual[1] - mu[1]
for(t in 2:N)
{
mu[t] <- beta0 + beta1*Annual[t-1]
eps[t] <- Annual[t] - mu[t]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="ar1.txt")
model.fit <- jags(data=ar.data,
model.file="ar1.txt",
parameters.to.save=c("beta0", "beta1"),
n.chains=3,
n.iter=2000,
n.burnin=1000)
model.fit
model.fit <- jags(data=ar.data,
model.file="ar1.txt",
parameters.to.save=c("beta0", "beta1"),
n.chains=3,
n.iter=2000,
n.burnin=1000)
model.fit
mus <- jags(data=ar.data,
model.file="ar1.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=2000,
n.burnin=1000,
DIC=FALSE)
mus <- data.frame(mus$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, mus$X50., col="red", lwd=2)
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
mu[1] ~ dnorm(0, 0.001)
# likelihood
eps[1] <- Annual[1] - mu[1]
for(t in 2:N)
{
mu[t] <- beta0 + beta1*eps[t-1]
eps[t] <- Annual[t] - mu[t]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="ar2.txt")
mus <- jags(data=ar.data,
model.file="ar2.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=2000,
n.burnin=1000,
DIC=FALSE)
mus <- data.frame(mus$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, mus$X50., col="red", lwd=2)
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
mu[1] ~ dnorm(0, 0.001)
# likelihood
eps[1] <- Annual[1] - mu[1]
for(t in 2:N)
{
mu[t] <- beta0 + beta1*eps[t-1]
eps[t] <- Annual[t] - mu[t]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="ma1.txt")
mus <- jags(data=ar.data,
model.file="ma1.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=2000,
n.burnin=1000,
DIC=FALSE)
mus <- data.frame(mus$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, mus$X50., col="red", lwd=2)
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
beta2 ~ dnorm(0, 0.001)
mu[1] ~ dnorm(0, 0.001)
# likelihood
eps[1] <- Annual[1] - mu[1]
for(t in 2:N)
{
mu[t] <- beta0 + beta1*eps[t-1] + beta2*mu[t-1]
eps[t] <- Annual[t] - mu[t]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="arma.txt")
mus <- jags(data=ar.data,
model.file="ar2.txt",
parameters.to.save=c("arma.txt"),
n.chains=3,
n.iter=2000,
n.burnin=1000,
DIC=FALSE)
mus <- data.frame(mus$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, mus$X50., col="red", lwd=2)
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
beta2 ~ dnorm(0, 0.001)
mu[1] ~ dnorm(0, 0.001)
# likelihood
eps[1] <- Annual[1] - mu[1]
for(t in 2:N)
{
mu[t] <- beta0 + beta1*eps[t-1] + beta2*mu[t-1]
eps[t] <- Annual[t] - mu[t]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="arma.txt")
mus <- jags(data=ar.data,
model.file="arma.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=2000,
n.burnin=1000,
DIC=FALSE)
mus <- data.frame(mus$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, mus$X50., col="red", lwd=2)
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
mu[1] ~ dnorm(0, 0.001)
# likelihood
eps[1] <- Annual[1] - mu[1]
for(t in 2:N)
{
mu[t] <- beta0 + beta1*Annual[t-1]
eps[t] <- Annual[t] - mu[t]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="ar1.txt")
model.fit <- jags(data=ar.data,
model.file="ar1.txt",
parameters.to.save=c("beta0", "beta1"),
n.chains=3,
n.iter=2000,
n.burnin=1000)
model.fit
mus <- jags(data=ar.data,
model.file="ar1.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=2000,
n.burnin=1000,
DIC=FALSE)
mus <- data.frame(mus$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, mus$X50., col="red", lwd=2)
cat("
model
{
# priors
tau <- 1/(sigma*sigma)
sigma ~ dunif(0, 100)
beta0 ~ dnorm(0, 0.001)
beta1 ~ dnorm(0, 0.001)
mu[1] ~ dnorm(0, 0.001)
# likelihood
eps[1] <- Annual[1] - mu[1]
for(t in 2:N)
{
mu[t] <- beta0 + beta1*mu[t-1]
eps[t] <- Annual[t] - mu[t]
}
for(t in 1:N)
{
Annual[t] ~ dnorm(mu[t], tau)
}
}
", file="ar1.txt")
mus <- jags(data=ar.data,
model.file="ar1.txt",
parameters.to.save=c("mu"),
n.chains=3,
n.iter=2000,
n.burnin=1000,
DIC=FALSE)
mus <- data.frame(mus$BUGSoutput$summary)
plot(Annual~Year, data=gtemp, type="b")
lines(gtemp$Year, mus$X50., col="red", lwd=2)
